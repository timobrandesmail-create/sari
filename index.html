<!doctype html>
.lane{display:flex;gap:12px;overflow:auto;padding-top:8px}
.p{min-width:320px}
input,select,textarea{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #2b3647;background:#0e1420;color:#e8eef6}
textarea{min-height:100px}
table{width:100%;border-collapse:separate;border-spacing:0 8px}
th{text-align:left;padding:8px;color:#93a4b6;font-size:12px}
.qg{font-size:12px}
.ok{color:#9fe6cb}
.open{color:#f6d18b}
.muted{color:var(--muted)}
</style>
</head>
<body>
<div class="grid">
<aside>
<div class="brand"><div class="logo"></div><div><div style="font-weight:700">SARI Governance</div><div style="font-size:12px;color:#9aacc0">Pitch Prototype</div></div></div>
<div class="nav"><a href="#/">üè† Dashboard</a></div>
</aside>
<main id="app"></main>
</div>


<script>
// ===== Pure JS (kein React/kein Build) =====
const addDays=(iso,d)=>{if(!iso)return null;const t=new Date(iso);const x=new Date(t.getTime());x.setDate(t.getDate()+d);return x.toISOString().slice(0,10)};
const todayISO=()=>new Date(Date.now()).toISOString().slice(0,10);
const daysBetween=(a,b)=>{if(!a||!b)return null;const A=new Date(a),B=new Date(b);return Math.round((B-A)/(24*3600*1000))};
const deltaFromToday=t=>t?daysBetween(todayISO(),t):null;
const el=(tag,attrs={},...kids)=>{const n=document.createElement(tag);for(const[k,v]of Object.entries(attrs)){if(k==='class')n.className=v;else if(k==='style')Object.assign(n.style,v);else if(k.startsWith('on'))n.addEventListener(k.slice(2),v);else n.setAttribute(k,v)};kids.forEach(c=>{if(c==null)return;if(typeof c==='string')n.appendChild(document.createTextNode(c));else n.appendChild(c)});return n};
const computeRPN=sod=>(+sod.s||0)*(+sod.o||0)*(+sod.d||0);
function QG(step,sari){
const S0=()=> step.s0 && step.s0.customer_informed_on && step.s0.first_event_date && daysBetween(step.s0.first_event_date,step.s0.customer_informed_on)<=1 && !!step.s0.containment_action_plan;
const S1=()=> step.s1 && step.s1.leader && step.s1.sponsor && step.s1.problem_owner && step.s1.operations_rep;
const S2=()=> step.s2 && step.s2.issue_description && step.s2.fiveWtwoH && (!step.s2.complex_case || (step.s2.complex_case && step.s2.is_is_not)) && !/\b(fix|l√∂sen|solution|workaround)\b/i.test(step.s2.issue_description);
const S3=()=> step.s3 && step.s3.containment_validation_report && (step.s3.traceability_report_toac || step.s3.traceability_alt) && step.s3.curative_actions_done===true;
const rpn=computeRPN(sari.sod);
const S4=()=> step.s4 && step.s4.rc1_occurrence && step.s4.rc2_non_detection && ((sari.level==='L1'||rpn>=300)?!!step.s4.rc3_systemic:true) && (step.s4.rc_evidence && step.s4.rc_evidence.length>0);
const S5=()=>{const a=step.s5?.pca||[];if(a.length===0)return false;const has={RC1:false,RC2:false,RC3:false};const need={RC1:!!sari.steps.s4.rc1_occurrence,RC2:!!sari.steps.s4.rc2_non_detection,RC3:!!sari.steps.s4.rc3_systemic};for(const p of a){if(!(p.action&&p.owner&&p.due_date&&p.effectiveness_metric&&p.rc_link))return false;if(has[p.rc_link]!==undefined)has[p.rc_link]=true;}return (!need.RC1||has.RC1)&&(!need.RC2||has.RC2)&&(!need.RC3||has.RC3)};
const Dry=()=> step.dry && step.dry.id_card_ready && step.dry.pca_plan_consistent && step.dry.demo_artifacts && step.dry.open_risks_listed;
const S6=()=>{const L=step.s6?.pca_effectiveness||[];if(L.length===0)return false;return L.every(e=>e.implemented===true&&e.effective===true&&!!e.effectiveness_evidence)};
const PP =()=> step.pp && step.pp.ppm_review_green && step.pp.risks_documented && step.pp.pp_pack_ready;
const S7=()=> step.s7 && step.s7.sop_updated && ((sari.level==='L1'||rpn>=300)? step.s7.fmea_updated : true);
const S8=()=> step.s8 && step.s8.checks && step.s8.checks.each_action_effective && step.s8.checks.docs_complete && step.s8.checks.lessons_integrated && step.s8.checks.five_why_valid;
return {S0:S0(),S1:S1(),S2:S2(),S3:S3(),S4:S4(),S5:S5(),Dry:Dry(),S6:S6(),PP:PP(),S7:S7(),S8:S8()}
}
function progress(s){const qg=QG(s.steps,s);const arr=Object.values(qg);return Math.round(arr.filter(Boolean).length/arr.length*100)}
function mkSari(id,level,day1,sod,meta={}){return {id,level,day1,sod,meta,milestones:{dryRun:{target:addDays(day1,60)},pp:{target:addDays(day1,100)}},status:'Open',steps:{s0:{first_event_date:day1,customer_informed_on:day1,line_stop:'Nein',containment_action_plan:{name:'plan.pdf'}},s1:{leader:'',sponsor:'',problem_owner:'',operations_rep:'',mft_members:[]},s2:{issue_description:'',fiveWtwoH:'',complex_case:false,is_is_not:'',supply_chain_breakdown:''},s3:{containment_validation_report:null,traceability_report_toac:null,traceability_alt:null,curative_actions_done:false},s4:{rc1_occurrence:'',rc2_non_detection:'',rc3_systemic:'',rc_evidence:[]},s5:{pca:[]},dry:{id_card_ready:false,pca_plan_consistent:false,demo_artifacts:false,open_risks_listed:false},s6:{pca_effectiveness:[]},pp:{ppm_review_green:false,risks_documented:false,pp_pack_ready:false},s7:{sop_updated:null,fmea_updated:null},s8:{checks:{each_action_effective:false,docs_complete:false,lessons_integrated:false,five_why_valid:false},customer_closure_comm:null,closure_comment:''}}}}
const DB=[mkSari('SE-25.0123','L1','2025-09-01',{s:8,o:5,d:9},{title:'GEN-004 Incorrect Assembly ‚Äì hinge bracket'}),mkSari('SE-25.0456','L2','2025-08-30',{s:6,o:6,d:6},{title:'GEN-010 Torque issue ‚Äì fasteners'}),mkSari('SE-25.0789','L3','2025-10-01',{s:4,o:5,d:7},{title:'GEN-001 FOD ‚Äì wiring bay'}),mkSari('SE-25.0999','L2','2025-07-20',{s:7,o:7,d:7},{title:'GEN-012 Corrosion ‚Äì panel'})];
DB[0].steps.s2.issue_description='1 object / 1 defect: hinge mis-assembly on LH door';
DB[0].steps.s5.pca=[{action:'Introduce Poka-Yoke',owner:'Ops',due_date:'2025-10-12',rc_link:'RC2',effectiveness_metric:'Cpk >=1.33',status:'In Arbeit'},{action:'Revise SOP 27-14',owner:'QE',due_date:'2025-10-20',rc_link:'RC3',effectiveness_metric:'Audit=0 NC',status:'Offen'}];
function urgencyTuple(s){const lvl=s.level==='L1'?3:s.level==='L2'?2:1;const dDry=deltaFromToday(s.milestones.dryRun?.target)??9999;const dPP=deltaFromToday(s.milestones.pp?.target)??9999;const rpn=computeRPN(s.sod);const overdue=(s.steps.s5.pca||[]).filter(p=>p.due_date&&p.status!=='Erledigt'&&p.due_date<todayISO()).length;return[-lvl,(dDry>=0?dDry:dDry*2),(dPP>=0?dPP:dPP*1.5),-rpn,-overdue]}
function cmp(a,b){for(let i=0;i<Math.max(a.length,b.length);i++){const d=(a[i]||0)-(b[i]||0);if(d!==0)return d}return 0}
function kpi(l,v,s){const r=el('div',{class:'card kpi'});r.append(el('div',{class:'l'},l),el('div',{class:'v'},String(v)));if(s)r.append(el('div',{class:'s'},s));return r}
function chip(txt,tone){return el('span',{class:'chip '+(tone||'')},txt)}
function renderDashboard(){const wrap=el('div');const open=DB.filter(s=>s.status!=='Closed').length;const overdueMs=DB.filter(s=>(deltaFromToday(s.milestones.dryRun?.target)??1)<0||(deltaFromToday(s.milestones.pp?.target)??1)<0).length;const avgDry=Math.round(DB.reduce((a,s)=>a+(deltaFromToday(s.milestones.dryRun?.target)??0),0)/Math.max(1,DB.length));const avgPP=Math.round(DB.reduce((a,s)=>a+(deltaFromToday(s.milestones.pp?.target)??0),0)/Math.max(1,DB.length));const topIrr=DB.filter(s=>s.level==='L1'||computeRPN(s.sod)>=300).length;const row=el('div',{class:'row c5'});row.append(kpi('Open SARIs',open),kpi('Overdue Milestones',overdueMs),kpi('√ò Days to Dry Run',avgDry),kpi('√ò Days to PP',avgPP),kpi('Top Irritants',topIrr));wrap.append(row);const sorted=[...DB].sort((a,b)=>cmp(urgencyTuple(a),urgencyTuple(b)));const grid=el('div',{class:'row c3',style:{gap:'16px'}});sorted.forEach(s=>grid.append(tile(s)));wrap.append(grid);return wrap}
function tile(s){const rpn=computeRPN(s.sod);const prog=progress(s);const dDry=deltaFromToday(s.milestones.dryRun?.target);const dPP=deltaFromToday(s.milestones.pp?.target);const dryTxt=dDry==null?'‚Äî':dDry<0?`DRY RUN ${Math.abs(dDry)}d overdue`:`DRY RUN in ${dDry}d`;const ppTxt=dPP==null?'‚Äî':dPP<0?`PP ${Math.abs(dPP)}d overdue`:`PP in ${dPP}d`;const overdue=(s.steps.s5.pca||[]).filter(p=>p.due_date&&p.status!=='Erledigt'&&p.due_date<todayISO()).length;const card=el('div',{class:'card tile'});card.addEventListener('click',()=>location.hash=`#/sari/${s.id}`);const head=el('div',{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'8px'}});head.append(el('div',{style:{fontWeight:'800'}},s.id));const badges=el('div',{style:{display:'flex',gap:'8px',alignItems:'center'}});badges.append(chip(s.level,'info'));if(s.level==='L1'||rpn>=300)badges.append(chip('Top Irritant','warn'));head.append(badges);card.append(head);card.append(el('div',{class:'muted'},s.meta?.title||s.steps?.s2?.issue_description||'‚Äî'));const row=el('div',{class:'row c3',style:{marginTop:'8px'}});const b1=el('div');b1.append(el('label',{class:'lab'},'RPN'),el('div',{style:{fontWeight:'700'}},String(rpn)),el('div',{class:'muted',style:{fontSize:'12px'}},`S/O/D ${s.sod.s}/${s.sod.o}/${s.sod.d}`));const b2=el('div');b2.append(el('label',{class:'lab'},'Fortschritt'),el('div',{style:{fontWeight:'700'}},`${prog}%`));const b3=el('div');b3.append(el('label',{class:'lab'},'Overdue Aktionen'),el('div',{style:{fontWeight:'700'}},String(overdue)));row.append(b1,b2,b3);card.append(row);const chips=el('div',{class:'row c2'});chips.append(el('div',{},chip(dryTxt,dDry<0?'warn':'info')));chips.append(el('div',{},chip(ppTxt,dPP<0?'warn':'info')));card.append(chips);return card}
function timeline(s){const nodes=[{id:'s0',label:'S0'},{id:'s1',label:'S1'},{id:'s2',label:'S2'},{id:'s3',label:'S3'},{id:'s4',label:'S4'},{id:'s5',label:'S5'},{id:'dry',label:'Dry Run',ms:true,target:s.milestones.dryRun?.target},{id:'s6',label:'S6'},{id:'pp',label:'PP',ms:true,target:s.milestones.pp?.target},{id:'s7',label:'S7'},{id:'s8',label:'S8'}];const bar=el('div',{class:'timeline'});nodes.forEach(n=>{const d=n.ms?deltaFromToday(n.target):null;const node=el('div',{class:'n'});const dot=el('div',{class:'d '+(n.ms?'ms':'')+' '+(d!=null&&d<0?'over':'')});node.append(dot,el('div',{style:{fontWeight:n.ms?800:600}},n.label));if(n.ms)node.append(el('div',{class:'muted',style:{fontSize:'12px'}},n.target||'‚Äî'));node.addEventListener('click',()=>document.querySelector(`[data-panel="${n.id}"]`)?.scrollIntoView({behavior:'smooth',inline:'start',block:'nearest'}));bar.append(node)});return bar}
function panel(title,id){const p=el('div',{class:'card p','data-panel':id});p.append(el('div',{style:{fontWeight:'700',marginBottom:'6px'}},title));return p}
function qg(ok){return el('div',{class:'qg '+(ok?'ok':'open')},ok?'Requirements OK':'Requirements offen')}
function f(label,input){const w=el('div');w.append(el('label',{class:'lab'},label),input);return w}
function iText(val,on){const i=el('input',{value:val||''});i.addEventListener('input',e=>on(e.target.value));return i}
function iDate(val,on){const i=el('input',{type:'date',value:val||''});i.addEventListener('input',e=>on(e.target.value));return i}
function iArea(val,on){const i=el('textarea',{});i.value=val||'';i.addEventListener('input',e=>on(e.target.value));return i}
function iCheck(val,on,label){const l=el('label',{style:{display:'flex',gap:'8px',alignItems:'center'}});const i=el('input',{type:'checkbox'});i.checked=!!val;i.addEventListener('change',e=>on(!!e.target.checked));l.append(i,document.createTextNode(label));return l}
function renderDetail(s){const wrap=el('div');const head=el('div',{class:'card'});const top=el('div',{style:{display:'flex',justifyContent:'space-between',alignItems:'center'}});const left=el('div');left.append(el('div',{style:{fontSize:'18px',fontWeight:'800'}},s.id),el('div',{class:'muted',style:{fontSize:'12px'}},`ATA ${s.meta?.ata||'‚Äî'} ‚Ä¢ SIM ${s.meta?.sim||'‚Äî'}`));const right=el('div',{style:{display:'flex',gap:'8px',alignItems:'center'}});right.append(chip(s.level,'info'),chip('RPN '+computeRPN(s.sod)),chip('Status '+s.status));top.append(left,right);head.append(top);wrap.append(head);wrap.append(el('div',{style:{height:'10px'}}));wrap.append(el('div',{class:'card'},timeline(s)));wrap.append(el('div',{style:{height:'10px'}}));const lane=el('div',{class:'lane'});
const p0=panel('S0 ‚Ä¢ Containment','s0');const S0=s.steps.s0;p0.append(qg(QG({s0:S0},s).S0));p0.append(f('First Event',iDate(S0.first_event_date,v=>{S0.first_event_date=v;render()})),f('Kundeninfo',iDate(S0.customer_informed_on,v=>{S0.customer_informed_on=v;render()})),f('Containment‚ÄëPlan (Ref)',iText(S0.containment_action_plan?.name||'',v=>{S0.containment_action_plan=v?{name:v}:null;render()})));lane.append(p0);
const p1=panel('S1 ‚Ä¢ Team Charter','s1');const S1=s.steps.s1;p1.append(qg(QG({s1:S1},s).S1));p1.append(f('Leader',iText(S1.leader,v=>{S1.leader=v})),f('Sponsor',iText(S1.sponsor,v=>{S1.sponsor=v})),f('Problem Owner',iText(S1.problem_owner,v=>{S1.problem_owner=v})),f('Operations',iText(S1.operations_rep,v=>{S1.operations_rep=v})));lane.append(p1);
const p2=panel('S2 ‚Ä¢ Evidence Hub','s2');const S2=s.steps.s2;p2.append(qg(QG({s2:S2},s).S2));p2.append(f('Issue (1 Objekt/1 Defekt)',iArea(S2.issue_description,v=>{S2.issue_description=v})),f('5W2H',iArea(S2.fiveWtwoH,v=>{S2.fiveWtwoH=v})));const cx=iCheck(!!S2.complex_case,v=>{S2.complex_case=v;render()},'Komplexer Fall (IS/IS NOT Pflicht)');p2.append(cx);if(S2.complex_case){p2.append(f('IS / IS NOT',iArea(S2.is_is_not,v=>{S2.is_is_not=v})))}lane.append(p2);
const p3=panel('S3 ‚Ä¢ Validate Containment','s3');const S3=s.steps.s3;p3.append(qg(QG({s3:S3},s).S3));p3.append(f('Validierungsbericht (Ref)',iText(S3.containment_validation_report?.name||'',v=>{S3.containment_validation_report=v?{name:v}:null;render()})),f('Traceability (TOAC/Alt)',iText(S3.traceability_report_toac?.name||S3.traceability_alt?.name||'',v=>{S3.traceability_report_toac=v?{name:v}:null;S3.traceability_alt=null;render()})),iCheck(!!S3.curative_actions_done,v=>{S3.curative_actions_done=v;render()},'Curative Actions umgesetzt'));lane.append(p3);
const p4=panel('S4 ‚Ä¢ RCA','s4');const S4=s.steps.s4;p4.append(qg(QG({s4:S4},s).S4));p4.append(f('RC1 (Occurrence)',iText(S4.rc1_occurrence,v=>{S4.rc1_occurrence=v})),f('RC2 (Non‚ÄëDetection)',iText(S4.rc2_non_detection,v=>{S4.rc2_non_detection=v})),f('RC3 (Systemic)',iText(S4.rc3_systemic,v=>{S4.rc3_systemic=v})));const ev=el('div');ev.append(el('label',{class:'lab'},'Evidenzen'),(()=>{const b=el('button',{class:'chip'},'‚ûï Evidenz');b.addEventListener('click',()=>{(S4.rc_evidence=S4.rc_evidence||[]).push({name:`evidence-${(S4.rc_evidence.length||0)+1}.pdf`});render()});return b})());if(S4.rc_evidence?.length){const ul=el('ul');S4.rc_evidence.forEach(e=>ul.append(el('li',{},e.name)));ev.append(ul)}p4.append(ev);lane.append(p4);
const p5=panel('S5 ‚Ä¢ Corrective Actions','s5');const S5=s.steps.s5;p5.append(qg(QG({s5:S5},s).S5));const addP=el('button',{class:'chip'},'‚ûï Ma√ünahme');addP.addEventListener('click',()=>{(S5.pca=S5.pca||[]).push({action:'',owner:'',due_date:'',rc_link:'RC1',effectiveness_metric:'',status:'Offen'});render()});p5.append(addP);if((S5.pca||[]).length===0){p5.append(el('div',{class:'muted'},'Keine Ma√ünahmen erfasst.'))}else{const tbl=el('table');const th=el('thead');const trh=el('tr');['Ma√ünahme','Owner','F√§llig','RC','Metrik','Status'].forEach(h=>trh.append(el('th',{},h)));th.append(trh);tbl.append(th);const tb=el('tbody');S5.pca.forEach((p,i)=>{const tr=el('tr');const rcSel=el('select',{});['RC1','RC2','RC3'].forEach(x=>rcSel.append(el('option',{value:x,selected:(p.rc_link||'RC1')===x},x)));rcSel.addEventListener('change',e=>{p.rc_link=e.target.value});const stSel=el('select',{});['Offen','In Arbeit','Erledigt'].forEach(x=>stSel.append(el('option',{value:x,selected:(p.status||'Offen')===x},x)));stSel.addEventListener('change',e=>{p.status=e.target.value});tr.append(el('td',{class:'td'},iText(p.action,v=>{p.action=v})),el('td',{class:'td'},iText(p.owner,v=>{p.owner=v})),el('td',{class:'td'},iDate(p.due_date,v=>{p.due_date=v})),el('td',{class:'td'},rcSel),el('td',{class:'td'},iText(p.effectiveness_metric,v=>{p.effectiveness_metric=v})),el('td',{class:'td'},stSel));tb.append(tr)});tbl.append(tb);p5.append(tbl)}lane.append(p5);
const pDry=panel('Milestone ‚Ä¢ Dry Run (‚â§60d)','dry');const DR=s.steps.dry;pDry.append(qg(QG({dry:DR},s).Dry));pDry.append(f('Zieltermin',el('div',{class:'td'},s.milestones.dryRun?.target||'‚Äî')),iCheck(!!DR.id_card_ready,v=>{DR.id_card_ready=v},'ID‚ÄëCard vorhanden'),iCheck(!!DR.pca_plan_consistent,v=>{DR.pca_plan_consistent=v},'PCA‚ÄëPlan konsistent'),iCheck(!!DR.demo_artifacts,v=>{DR.demo_artifacts=v},'Demo‚ÄëArtefakte vorhanden'),iCheck(!!DR.open_risks_listed,v=>{DR.open_risks_listed=v},'Offene Risiken gelistet'));lane.append(pDry);
const p6=panel('S6 ‚Ä¢ Implement & Effectiveness','s6');const S6=s.steps.s6;p6.append(qg(QG({s6:S6},s).S6));const addE=el('button',{class:'chip'},'‚ûï Wirksamkeitsnachweis');addE.addEventListener('click',()=>{(S6.pca_effectiveness=S6.pca_effectiveness||[]).push({pca_index:0,implemented:false,effective:false,effectiveness_evidence:{name:'evidence.pdf'}});render()});p6.append(addE);if((S6.pca_effectiveness||[]).length===0){p6.append(el('div',{class:'muted'},'Noch keine Wirksamkeitsnachweise.'))}else{const ul=el('ul');S6.pca_effectiveness.forEach(e=>{const li=el('li');li.append(iCheck(!!e.implemented,v=>{e.implemented=v},'Implementiert'),' ',iCheck(!!e.effective,v=>{e.effective=v},'Wirksam'),' ',f('Evidenz',iText(e.effectiveness_evidence?.name||'',v=>{e.effectiveness_evidence=v?{name:v}:null})));ul.append(li)});p6.append(ul)}lane.append(p6);
const ppp=panel('Milestone ‚Ä¢ PP (‚â§100d)','pp');const PP=s.steps.pp;ppp.append(qg(QG({pp:PP},s).PP));ppp.append(f('Zieltermin',el('div',{class:'td'},s.milestones.pp?.target||'‚Äî')),iCheck(!!PP.ppm_review_green,v=>{PP.ppm_review_green=v},'PPM‚ÄëReview abgeschlossen'),iCheck(!!PP.risks_documented,v=>{PP.risks_documented=v},'Residualrisiken dokumentiert'),iCheck(!!PP.pp_pack_ready,v=>{PP.pp_pack_ready=v},'PP‚ÄëPack bereit'));lane.append(ppp);
const p7=panel('S7 ‚Ä¢ Standardize & Prevent','s7');const S7=s.steps.s7;p7.append(qg(QG({s7:S7},s).S7));p7.append(f('SOP aktualisiert (Ref)',iText(S7.sop_updated?.name||'',v=>{S7.sop_updated=v?{name:v}:null;render()})),f('FMEA aktualisiert (Ref)',iText(S7.fmea_updated?.name||'',v=>{S7.fmea_updated=v?{name:v}:null;render()})));lane.append(p7);
const p8=panel('S8 ‚Ä¢ Close & Recognize','s8');const S8=s.steps.s8;p8.append(qg(QG({s8:S8},s).S8));const c=S8.checks;p8.append(iCheck(!!c.each_action_effective,v=>{c.each_action_effective=v},'Wirksamkeit je Ma√ünahme belegt'),iCheck(!!c.docs_complete,v=>{c.docs_complete=v},'Dokumente vollst√§ndig'),iCheck(!!c.lessons_integrated,v=>{c.lessons_integrated=v},'Lessons Learned integriert'),iCheck(!!c.five_why_valid,v=>{c.five_why_valid=v},'5‚ÄëWhys zeigen tats√§chliche RC'));p8.append(f('Kundenkommunikation (Ref)',iText(S8.customer_closure_comm?.name||'',v=>{S8.customer_closure_comm=v?{name:v}:null})),f('Abschluss‚ÄëKommentar',iArea(S8.closure_comment,v=>{S8.closure_comment=v})));lane.append(p8);
wrap.append(lane);
const kp=el('div',{class:'row c4'});
kp.append(kpi('RPN',computeRPN(s.sod),`S/O/D ${s.sod.s}/${s.sod.o}/${s.sod.d}`));
kp.append(kpi('Fortschritt 9S',progress(s)+'%'));
const dDry=deltaFromToday(s.milestones.dryRun?.target);const dPP=deltaFromToday(s.milestones.pp?.target);
kp.append(kpi('Dry Run',(s.milestones.dryRun?.target||'‚Äî'),dDry==null?'‚Äî':(dDry<0?`overdue ${Math.abs(dDry)}d`:`in ${dDry}d`)));
kp.append(kpi('PP',(s.milestones.pp?.target||'‚Äî'),dPP==null?'‚Äî':(dPP<0?`overdue ${Math.abs(dPP)}d`:`in ${dPP}d`)));
wrap.append(kp);
return wrap;
function render(){renderApp()}
}
function renderApp(){const app=document.getElementById('app');app.innerHTML='';const hash=location.hash.replace(/^#\/?/,'');const seg=hash.split('/');if(!hash||seg[0]===''||seg[0]==='dashboard'){app.append(renderDashboard());return}if(seg[0]==='sari'&&seg[1]){const s=DB.find(x=>x.id===seg[1]);app.append(s?renderDetail(s):el('div',{class:'card'},'Unbekanntes SARI.'));return}app.append(renderDashboard())}
window.addEventListener('hashchange',renderApp);
renderApp();
</script>
</body>
</html>
